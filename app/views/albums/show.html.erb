<%= content_for :breadcrumb do %>
	<li class="active"><%= link_to @album.title, @album %></li>
<% end %>

<p id="notice"><%= notice %></p>


<div class="row">
  <div class="col-md-8">
	<h1><%= @album.title %></h1>
	<p class="">
	  <%= @album.description %>
	</p>
  	
  </div>
  <div class="col-md-4">
  	
	<div class="btn-toolbar">
		<div class="btn-group btn-group-sm">
		  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
		    	 <span class="glyphicon glyphicon-eye-open"></span>
				 <% if @user_filter %>
				 	<%=t :from %>: <%= @user_filter.name %>
				 <% else %>
				 	<%=t :show %>: <%=t :all %>
				 <% end %>
				<span class="caret"></span>
		  </button>
		  <ul class="dropdown-menu" role="menu">
			<% @album.users.each do |user| %>
				<li><a href="<%= album_path(@album, :user_id => user.id) %>"><%= user.name %></a></li>
			<% end %>
		    <li class="divider"></li>
		    <li><a href="<%= album_path(@album) %>"><%=t :show %> <%=t :all %></a></li>
		  </ul>
		</div>	
		
		<div class="btn-group btn-group-sm">
			<%= link_to album_upload_path(@album), :class => "btn btn-success" do %>
				<span class="glyphicon glyphicon-upload"></span> <%=t :upload_photos %>
			<% end %> 
		</div>
		<!--
		<div class="btn-group btn-group-sm">
			<%= link_to 'Edit', edit_album_path(@album), :class => "btn btn-default" %>
		</div>
		-->
	</div>
	
  </div>
</div>



<br/>


<div id="photo-container">
	<% for photo in @photos do  %>
		<div class="photo-elem">
			<% if photo.image_processed && photo.image_file.thumb_square && photo.image_file.single %>
				<%= link_to image_tag( photo.image_file.thumb_square.url, :class => "img-responsive" ), [photo.album,photo], "data-mfp-src" => photo.image_file.single.url, :title => photo.title, :class => "view", "data-capture-time" => ( photo.capture_time.blank? ? '' : photo.capture_time.strftime("%b %d %Y, %H:%M")  ), "data-user" => (photo.user ? photo.user.name : ""), "data-fullsize" => photo.image_file.file.url %>
			<% else %>
				<%= link_to image_tag("processing.jpg", :class => "img-responsive img-rounded"), @album %>
			<% end %>
		</div>
	<% end %>
</div>

<% content_for :javascript do %>
<script type="text/javascript">
	$(document).ready(initializeLightbox);
	
	$('#photo-container').imagesLoaded()
	  .progress( function( instance, image ) {
	    var result = image.isLoaded ? 'loaded' : 'broken';
  	    //console.log( 'image is ' + result + ' for ' + image.img.src + ' with class ' + image.img.className );
		image.img.className = image.img.className + " fadeIn";
	  });
</script>
<% end %>